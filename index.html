<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinÃ©â€‘Data : Ã‰volution Box Office 2013â€‘2023</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --or: #d4af37;
            --velours: #800020;
            --noir: #0f0f0f;
            --glass: rgba(255,255,255,0.05);
        }
        body {
            background: var(--noir);
            color: #fff;
            font-family: 'Montserrat', sans-serif;
            margin: 0; overflow-x: hidden;
        }
        header {
            background: linear-gradient(rgba(0,0,0,0.7),rgba(0,0,0,0.7)), url('https://images.unsplash.com/photo-1505682634904-d7c3cb86ab46?q=80&w=2000');
            background-size: cover; background-position: center;
            height: 300px; display:flex; justify-content:center; align-items:center;
            border-bottom: 4px solid var(--or);
        }
        header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem; color: var(--or); text-transform: uppercase; letter-spacing: 3px;
        }
        .timeline {
            text-align:center; padding: 30px;
        }
        .year-label { font-size:3.5rem; font-weight:700; color:var(--or); }
        input[type="range"] { width:80%; accent-color:var(--or); margin-top:20px; }

        .films { display:grid; gap:20px; grid-template-columns: repeat(auto-fit,minmax(180px,1fr)); padding:0 20px; max-width:1200px; margin:auto 40px;}
        .film-card { background:#222; border-radius:10px; overflow:hidden; cursor:pointer; border:2px solid #333; transition:0.3s; }
        .film-card:hover { border-color:var(--or); transform:scale(1.05); box-shadow:0 0 15px rgba(212,175,55,0.4); }
        .film-card img { width:100%; height:280px; object-fit:cover; }
        .film-card-body { padding:10px; text-align:center; }
        .film-card h3 { font-size:1rem; margin:5px 0; height:40px; overflow:hidden; }

        #analysis { display:none; background:white; color:#111; padding:30px; border-radius:12px; max-width:900px; margin:30px auto; }
        #topChart { width:100%; height:400px; }
        .btn { background:var(--velours); color:#fff; padding:10px 20px; border-radius:25px; border:1px solid var(--or); cursor:pointer; font-weight:bold; transition:0.2s;}
        .btn:hover { background:#a00028; transform:translateY(-2px); }
        .toolbar { display:flex; justify-content:center; gap:15px; margin-bottom:30px; }
        .search-bar { padding:10px 15px; border-radius:25px; border:1px solid var(--or); background:transparent; color:#fff; width:280px;}
    </style>
</head>
<body>

<header><h1>Grand Ã‰cran : Box Office 2013â€‘2023</h1></header>

<section class="timeline">
    <div class="year-label" id="yearLabel">2013</div>
    <input type="range" id="yearSlider" min="2013" max="2023" value="2013">
    <div class="toolbar">
        <input type="text" id="search" class="search-bar" placeholder="Rechercher film ou rÃ©alisateur" oninput="updateView()">
        <button class="btn" onclick="toggleAnalysis()">ðŸ“Š Analyse du Top 1</button>
    </div>
</section>

<div id="analysis">
    <h2>Ã‰volution des recettes mondiales du film nÂ°â€¯1 (2013â€¯â†’â€¯2023)</h2>
    <canvas id="topChart"></canvas>
    <button class="btn" onclick="exportPDF()">Exporter PDF ðŸ“„</button>
</div>

<div class="films" id="filmsGrid"></div>

<script>
const topFilms = [
    {year:2013, title:"Frozen", revenue:1274, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/kgwjIbS69p7S9o6k9Y9UB9S966C.jpg"},
    {year:2014, title:"Transformers: Age of Extinction", revenue:1104, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/j73qpCAs9YvF6vYpSAnp9pogpSAn.jpg"},
    {year:2015, title:"Star Wars: The Force Awakens", revenue:2058, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/kUL4LYE0orto1lE5rEz3qck5m3k.jpg"},
    {year:2016, title:"Captain America: Civil War", revenue:1153, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/5Oe3L70C0sif2PJ4YAh1tnb9vVk.jpg"},
    {year:2017, title:"Star Wars: The Last Jedi", revenue:1322, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/kOVEVeg59E0wsnXmF9nrh6OmWII.jpg"},
    {year:2018, title:"Avengers: Infinity War", revenue:2048, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/7WsyChQLEftFiDOVTGkv3hFpyyt.jpg"},
    {year:2019, title:"Avengers: Endgame", revenue:2799, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/or06_st_st_9_st_8_st_6.jpg"},
    {year:2020, title:"Bad Boys for Life", revenue:426, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/kwLokBo4K0luZfIuU1LPFduQRE3.jpg"},
    {year:2021, title:"Spider-Man: No Way Home", revenue:1921, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/1g0dhYtq4irTY1GPXvft6k4YLjm.jpg"},
    {year:2022, title:"Avatar: The Way of Water", revenue:2320, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/t6_st_5_st_4_st_3.jpg"},
    {year:2023, title:"Barbie", revenue:1445, poster:"https://www.themoviedb.org/t/p/w600_and_h900_bestv2/iu_st_9_st_8_st_7.jpg"}
];

const grid = document.getElementById("filmsGrid");
const slider = document.getElementById("yearSlider");
const label = document.getElementById("yearLabel");

function updateView() {
    const year = parseInt(slider.value);
    const search = document.getElementById("search").value.toLowerCase();
    label.textContent = year;
    grid.innerHTML = "";

    const film = topFilms.find(f => f.year===year);
    if(film && film.title.toLowerCase().includes(search)) {
        const card = document.createElement("div");
        card.className = "film-card";
        card.innerHTML = `
            <img src="${film.poster}" alt="${film.title}">
            <div class="film-card-body">
                <h3>${film.title}</h3>
                <strong>${film.revenue}â€¯M$</strong>
            </div>
        `;
        grid.appendChild(card);
    }
}

let chart;
function toggleAnalysis() {
    const sec = document.getElementById("analysis");
    sec.style.display = sec.style.display==="block"?"none":"block";

    if(!chart) {
        const ctx = document.getElementById("topChart").getContext("2d");
        chart = new Chart(ctx, {
            type:'line',
            data:{
                labels: topFilms.map(f=>f.year),
                datasets:[{
                    label:"Recettes Topâ€¯1 (en millions $)",
                    data: topFilms.map(f=>f.revenue),
                    borderColor:"#800020",
                    backgroundColor:"rgba(128,0,32,0.15)",
                    tension:0.3,
                    fill:true
                }]
            },
            options:{
                scales:{
                    y:{ beginAtZero:true }
                },
                responsive:true
            }
        });
    }
}

function exportPDF() {
    const { jsPDF } = window.jspdf;
    html2canvas(document.getElementById("analysis")).then(canvas => {
        const img = canvas.toDataURL("image/png");
        const pdf = new jsPDF('p','mm','a4');
        pdf.addImage(img,'PNG',10,10,190,100);
        pdf.save("boxoffice_2013_2023.pdf");
    });
}

slider.oninput = updateView;
window.onload = updateView;
</script>

</body>
</html>
